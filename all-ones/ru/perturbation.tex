\section{Возмущённый случай}

Рассмотрим возмущённую матрицу единиц
\( \almostallones{M}{N} \) размерности \( N \),
состоящую из \( N^2 - M \) единиц и \( M \) нулей.

Её можно представить в виде
\[
    \almostallones{M}{N} = \allones{N} - \perturbmatrix{M}{N}
    \]
Где \( \allones{N} \) --- матрица единиц,
а \( \perturbmatrix{M}{N} \) -- матрица-возмущение,
имеющая единицы в точности в тех местах,
на которых в \( \almostallones{M}{N} \) стоят нули.

Задача состоит в оценке спектра возмущённой матрицы.

\begin{lemma}
    Подобные матрицы имеют одинаковый спектр
\end{lemma}

Применяя полученную в \eqref{eq:diagtransform} матрицу преобразования,
получаем, что \( \almostallones{M}{N} \) подобна (а значит разделяет с ней общий спектр)
матрице
\[ A - B \]
Где
\[
    A = \transformmatrix{T}{\allones{N}}
    = \begin{pmatrix}
      N &   &        & \\
        & 0 &        & \\
        &   & \ddots & \\
        &   &        & 0
        \end{pmatrix}
        \]
\[
    B = \transformmatrix{T}{\perturbmatrix{M}{N}}
    \]
Снова, пропущенные элементы матрицы -- нулевые.

\subsection{Общая схема метода подобных операторов}
Следуя общей схеме, мы будем искать матрицу, подобную \( A - B \)
в виде
\[ A - J X \]
с матрицей подобия вида
\[ U = E + \Gamma X ,\]
где \[ J, \Gamma \in \End{\mathfrak U} \subset \matr{N}{} \]
-- линейные операторы (трансформаторы),
действующие на некотором \( \mathfrak U \),
называемом пространством допустимых возмущений,
и подбираемые в ходе решения так, чтобы матрица \( A - JX \)
имела как можно более простую структуру.

Иначе говоря, будем искать решение \( X \in\matr{N}{} \)
уравнения подобия
\begin{equation}\label{eq:similarity-orig}
    (A - B)(E+\Gamma X) = (E+\Gamma X) (A - JX)
\end{equation}

В пространстве \( \mathfrak U \)
мы будем запускать итерационный процесс (применяя теорему Банаха о неподвижной точке),
и, как ниже будет видно, необходимо \( B \in \mathfrak U \)
и возникающие далее операторы также не должны отображать аргумент за пределы
пространства допустимых возмущенний.
В виду способа построения матрицы \( B \), сказать что-либо о её структуре затруднительно,
поэтому мы вынуждены выбрать \( \mathfrak U = \matr{N}{}\).

Пространство \( \mathscr{X} \) представим в виде
декартова произведения
\[ \mathscr{X} \sim \mathscr{X}_1\times\mathscr{X}_2 \]
одномерного пространства \( \mathscr{X}_1=\RR \)
и \((n-1)\)-мерного пространства \( \mathscr{X}_2 \),
элементы этого пространства в виде
\[ x=\begin{pmatrix}x_1\\x_2\end{pmatrix}, \]
\( x_i\in\mathscr{X}_i \).
Матрицы из \( \matr{N}{} \) будем записывать
в блочном виде:
\[
    X = \begin{pmatrix}
    X_{11} & X_{12} \\
    X_{21} & X_{22}
    \end{pmatrix},
    \]
где \( X_{11}\in\RR \) --- число,
    \( X_{12} \) -- строка длины \( N-1 \),
    \( X_{21} \) -- столбец,
    \( X_{22} \in \matr{N-1}{} \).
При этом произведению матриц соответствует произведение блочных матриц. 

Вернёмся к задаче.
Оператор \( \Gamma X \) определим как решение уравнения
\[
    \ad{A}{\Gamma X} = X - JX
    \qquad
    \footnote{\(\ad{Y}{} \) --- оператор коммутирования с \(Y\): \( \ad{Y}{Z} = YZ - ZY \) }
    \]
Пусть  \( \Gamma X \) задаётся блочной матрицей
\[ \Gamma X =
\begin{pmatrix}
    \Gamma_{11}(X) & \Gamma_{12}(X) \\
    \Gamma_{21}(X) & \Gamma_{22}(X)
\end{pmatrix}, \]
тогда
\[
    \ad{A}{\Gamma X} = A \Gamma X - (\Gamma X) A =
    \frac{1}{N}
\begin{pmatrix}
    0               & \Gamma_{12}(X) \\
    -\Gamma_{21}(X) & 0             
\end{pmatrix}
    . \]

Положим теперь
\[
    JX = \begin{pmatrix}
        X_{11} & 0 \\
        0      & X_{22}
    \end{pmatrix},
    \]
\[ \Gamma X =
    \begin{pmatrix}
        0       & X_{12} \\
        -X_{21} & 0
    \end{pmatrix}.
    \]
При этом матрица \( A - JX \) оказывается блочно-диагональной структуры
и, что легко проверить, её спектр есть объединение спектров её диагональных блоков.
Естественнее было бы начать с выбора оператора \( J \) доставляющего структуру,
как можно более близкую к \( A \).
Первым делом хочется рассмотреть оператор \( X\mapsto X_{11} \),
как самый согласованный с \( A \).
К сожалению, такой выбор \( J \) не позволяет решить уже уравнение для \(\Gamma\) во всём \(\mathfrak U = \matr{N}{}\),
и мы приходим к блочно-диагональному виду.

Развернём теперь уравнение \eqref{eq:similarity-orig}

\[
    A - B + A\Gamma X - B\Gamma X = A - JX + (\Gamma X) A - (\Gamma X) JX
    \]
\[
    A\Gamma X - (\Gamma X) A + JX = B \Gamma X + B - (\Gamma X) JX
    \]
\[
    X = B \Gamma X + B - (\Gamma X) JX
    \]
Применяя слева обратимый оператор \( J \) и подставляя результат обратно, получим уравнение
\begin{equation}\label{eq:similarity2}
    X = B \Gamma X + B - (\Gamma X) (J(B\Gamma X + B))
\end{equation}

Теперь мы докажем существование единственного решения \eqref{eq:similarity2}
и выведем оценки спектра,
показав, что в правой части этого уравнения стоит образ \( X \)
при сжимающем (в некотором шаре с центром в нуле) отображении \( \Phi \):
\[ \Phi(X) = B \Gamma X + B - (\Gamma X) (J(B\Gamma X + B)) \]

\subsection{Существование инвариантного множества}
Покажем сначала существование такого шара \( X\in\matr{N}{}; \{ \norm{X} \leq \varepsilon \} \),
который содержит свой образ при отображении \( \Phi \)
(другими словами, матрицы из этого шара
 не покидают его под действием \( \Phi \))

Будем считать, что алгебре матриц \( \matr{N}{} \)
введена норма, согласованная%
\footnote{согласованной с векторным пространством называется
матричная норма, удовлетворяющая неравенству \( \norm{A x} \leq \norm{A}\norm{x} \),
для всех \( A\in\matr{N}{}, x\in\RR^n \), где нормы взяты в соответствующих пространствах}
с \( \mathscr X = \RR^n \),
а в пространстве \( \End{\matr{N}{}} \) трансформаторов
используется обычная операторная норма%
\footnote{операторная норма
(матрицы или оператора) \( \mathcal A \)
вводится как точная нижняя грань таких констант \( C > 0 \),
что для всех \( x\in\mathscr X\) имеет место
(\( \norm{A x} \leq C \norm{x} \)), короче
\( \operatornorm{A} \) есть точная нижняя грань согласованных норм \( \norm{A} \)}

\begin{align*}
    \norm{\Phi(X)} &= \norm{B \Gamma X + B - (\Gamma X) (J(B\Gamma X + B))} \leq \\
%    &\leq \norm{B}\norm{\Gamma}\norm{X} + \norm{B} + \norm{\Gamma}\norm{X} (\norm{B}\norm{\Gamma}\norm{X}+\norm{B}) \leq \\
    &= \gamma^2\beta\norm{X}^2 + 2\gamma\beta\norm{X} + \beta
\end{align*}
Где \[ \beta=\norm{B}, \gamma=\norm{\Gamma} \]
Пока что отложим оценку этих величин.

\begin{lemma}
    Если
    \[ \gamma\beta \leq \frac14 \]
    То \( \Phi \) отображает в себя шар
    \[ \Omega = \{ X\in\matr{N}{} ; \norm{X}\leq r_0 \} \]
    \[ r_0 = \frac{1 - 2\gamma\beta - \sqrt{1-4\gamma\beta}}{2\gamma^2\beta} \]
    \[ 0 < r_0 \leq 4\beta \]
\end{lemma}
\begin{proof}
    Обозначим \( r=\norm{X} \). Тогда
    \( \norm{\Phi(X)} \leq \norm{X} \), если
    \begin{equation}\label{eq:omega-invariance}
        \gamma^2\beta r^2 + (2\gamma\beta - 1) r + \beta \leq 0
    \end{equation}
    Детерминант возникшего многочлена:
    \( \Delta = 1 - 4\gamma\beta\).
    Стало быть, если \( {\gamma\beta \leq \frac14} \),
    то определённое выше \( r_0 \) есть наименьшее \( r \),
    удовлетворяющее неравенству \eqref{eq:omega-invariance}
    
    Наконец, \( r_0 \geq 0 \):
    \begin{align*}
        1 - 2\gamma\beta - \sqrt{1-4\gamma\beta} > 0 \marginnote{\( 1-4\gamma\beta \geq 0 \)}\\
        \iff
        1-4\gamma\beta + 4\gamma^2\beta^2 > 1 - 4\gamma\beta \\
        \iff
        4\gamma^2\beta^2 \geq 0 \quad \text{что верно}
    \end{align*}
    И \( r_0 \leq 4\beta \):
    \begin{align*}
        r_0 \leq \varepsilon\beta \\
        \iff 1-2\gamma\beta-\sqrt{1-4\gamma\beta} \leq 2\varepsilon\gamma^2\beta^2 \\
        \iff 1 - 2\gamma\beta(1+\gamma\beta\varepsilon) \leq \sqrt{1-4\gamma\beta} \\
        \iff 1 - 4\gamma\beta(1+\gamma\beta\varepsilon)+4\gamma^2\beta^2(1+\gamma\beta\varepsilon)^2 \leq 1-4\gamma\beta \\
        \iff (1+\gamma\beta\varepsilon)^2\leq\varepsilon \marginnote{\(\gamma\beta\leq\frac14\)} \\
        \impliedby \frac{1}{16}\varepsilon^2 - \frac{1}{2} \varepsilon + 1 \leq 0 \\
        \iff \varepsilon=4 \\
    \end{align*}
\end{proof}

\subsection{Существование и единственность неподвижной точки}
Определим теперь, при каких условиях \( \Phi \) будет сжимающим в найдённом шаре.
\begin{lemma}
    \[ \norm{\Phi(X)-\Phi(Y)} \leq q \norm{X-Y} \]
    \[ q<1 \]
\end{lemma}
\begin{proof}
    \begin{align*}
        \Phi(X) - \Phi(Y) = & B\Gamma (X-Y) - \frac12 \left[
            \Gamma (X + Y)J(B\Gamma(X - Y)) + 
            \Gamma (X - Y)J(B\Gamma(X + Y))
        \right] \quad\footnotemark
    \end{align*}
    \footnotetext{\(
        (\Gamma X)J(B\Gamma X) - (\Gamma Y)J(B\Gamma Y) =
        \frac12
        \left(
            (\Gamma X + \Gamma Y)(J(B\Gamma X) - J(B\Gamma Y)) +
            (\Gamma X - \Gamma Y)(J(B\Gamma X) + J(B\Gamma Y))
        \right) \)}
    \[
        \norm{\Phi(X) - \Phi(Y)} \leq (1 + \gamma\norm{X+Y})\beta\gamma \norm{X-Y} \leq q\norm{X-Y}
        \]
    Где
    \begin{equation}\label{eq:lipconst}
        q = (1+2\gamma r_0)\gamma\beta
        \leq (1+8\gamma\beta)\gamma\beta \leq \frac{3}{4} \marginnote{\(\gamma\beta \leq \frac14\) \(r_0\leq 4\beta\)}
    \end{equation}
    Что и значит, что \( \Phi \) --- сжимающее отображение в найдённом шаре
\end{proof}

Сразу следует вывод
\begin{lemma}
    Пусть \( \gamma=\norm{\Gamma}, \beta=\norm{B}, \gamma\beta\leq\frac14 \),

    Обозначим
    \[ \Omega = \{ X\in\matr{N}{} ; \norm{X}\leq r_0 \} \]
    \[ r_0 = \frac{1 - 2\gamma\beta - \sqrt{1-4\gamma\beta}}{2\gamma^2\beta} \]
    \[ q = (1+2\gamma r_0)\gamma\beta \]

    Тогда \( \Phi \) есть сжимающее отображение \(\Omega\to\Omega\) шара \(\Omega\) в себя,
    и в этом шаре существует единственное решение \( X^o \) уравнения
    \eqref{eq:similarity2} \( X=\Phi(X) \),

    При этом имеют место оценки:
    \[
        \norm{X^o} \leq r_0 \leq 4\beta
        \]
    \[
        \norm{X^k - X^o} \leq \frac{q^k}{1-q}\beta
        \]
\end{lemma}
\begin{proof}
    \( \Omega \) --- замкнутое подмножество банахова пространства \( \matr{N}{} \),
    \( \Phi: \Omega\to\Omega \) -- сжимающее отображение.
    По теореме Банаха о неподвижной точке, в шаре существует единственное решение \( X^o \)
    уравнения \( X = \Phi (X) \),
    доставляемое методом простых итераций (c нулём в качестве начального приближения),
    как предел сходящейся последовательности
    \[
        \{X_k = \Phi^k(0); k\in\NN\}
        \]
    Грубейшая верхняя оценка его нормы --- радиус шара \( \Omega \).
\end{proof}

\subsection{Оценка спектра}
Итак, существует решение \( X^o \) уравнения
\( (A-B)(I+\Gamma X) = (I+\Gamma X)(A-JX) \),
или, другими словами, существует такая матрица
\( X^o =
\begin{pmatrix}
    x_{11} & x_{12} \\
    x_{21} & x_{22}
\end{pmatrix}
\),
что \( A-B \) и \( A - JX^o \) подобны.
При этом \( \norm{X^o} \leq r_0 \leq 4\norm{B} \),
а \( A - JX^o \) --- блочнодиагональна.

\[
    A-B \sim
    \begin{pmatrix}
        N - x_{11} & 0 \\
        0          & -X_{22}^o
    \end{pmatrix}
    \]

\begin{lemma}
    Спектр \( A - B \) состоит из числа \( N - x_{11} \)
    и спектра матрицы \( -X_{22} \)
    \[ \spec{A-B} = \{ \lambda_1 = N - x_{11} \} \cup \spec{-X_{22}} \]
    При этом
    \[ \lvert \lambda_1 - N \rvert \leq r_0 \]
    И для всех \( \lambda\in\spec{A-B}\setminus\{\lambda_1\} \)
    \[ \lvert\lambda\rvert \leq r_0 \]
\end{lemma}

Теперь требуемые результаты мы получим оценив \( \beta, \gamma \).

В ходе рассуждений предполагалось, что норма в \( \matr{N}{} \)
согласована с векторным пространством,
а в \( \End{\matr{N}{}} \) используется обычная операторная норма.
Теперь будем считать, что и в \( \matr{N}{} \)
также выбрана операторная норма  (обозначим её \( \operatornorm{\cdot} \)),
которая дала бы нам наиболее тонкие оценки.
\[ \beta = \operatornorm{B}, \gamma = \norm{\Gamma} = \sup_{\operatornorm{X}=1} \operatornorm{\Gamma X} \]
где, напомню, \( B = T^{-1} \perturbmatrix{M}{N} T \)
получена из матрицы возмущения с \( M \) единицами применением преобразования \eqref{eq:diagtransform},
диагонализирующего матрицу единиц,
а \( \Gamma \) --- оператор из \( \End{\matr{N}{}} \),
определённый формулой
\( \Gamma X = \frac1N \begin{pmatrix}0 & X_{12} \\ -X_{21} & 0\end{pmatrix} \).

\begin{lemma}
    Имеют место оценки
    \[ \gamma = \frac1N ,\]
    \[ \beta \leq \sqrt{M} ,\]
    где \( M \) --- число единиц в матрице \( \perturbmatrix{M}{N} \) возмущения
    (число нулей в исходной матрице \( \almostallones{M}{N} \))
\end{lemma}
\begin{proof}
    \[ \norm{(\Gamma X) x} = \frac1N \norm{\begin{pmatrix}x_2\\-x_1\end{pmatrix}} \]

    \[
        \norm{\Gamma} = \sup_{\norm X = 1} \operatornorm{\Gamma X}
        = \sup_{\norm X = 1} \sup_{\norm x = 1} \norm{(\Gamma X)x} = \frac1N
        \]
    Теперь рассмотрим в \( \matr{N}{} \) норму
    \( \normex{2}{Z} = \sqrt{\sum_{ij} z_{ij}^2} \).
    Тогда \( \normex{2}{\perturbmatrix{M}{N}} \)
    это суть корень из числа \( M \) единиц в \( \perturbmatrix{M}{N} \).
    Ясно, что \( \normex{2}{\cdot} \) соласована и \( \operatornorm{Z} \leq \normex{2}{Z} \).
    Остаётся заметить, что умножение на унитарную матрицу \( T \)
    (и \( T^{-1} \)) есть изометрия
    в \( \matr{N}{} \)
    и поэтому
    \[ \norm{B} = \norm{\perturbmatrix{M}{N}} \]
    \[ \beta \leq \normex{2}{B} = \normex{2}{\perturbmatrix{M}{N}} = \sqrt{M} \]
\end{proof}

Наконец, можем сформулировать первый (грубый) результат:
\begin{thm}[О грубой оценке собственных значений возмущённой матрицы единиц]
    Пусть \( \almostallones{M}{N} \) -- матрица размерности \( N \),
    состоящая из \( N^2 - M \) единиц и \( M \) нулей.

    Если
    \[
        M \leq \frac{N^2}{16}
        \]

    То у матрицы \( \almostallones{M}{N} \) есть в точности одно собственное
    значение \( \lambda_1 \), удовлетворяющее неравенству
    \[ \lvert \lambda_1 - N \rvert \leq 4\sqrt{M} ,\]
    а остальные собственные значения \( \lambda\in\spec{\almostallones{M}{N}} \setminus \{\lambda_1\} \)
    лежат в отрезке \( \left[-4\sqrt{M},+4\sqrt{M}\right] \):
    \[ \lvert \lambda \rvert \leq 4\sqrt{M} \]
\end{thm}
\begin{proof}
    \[
        \spec{\almostallones{M}{N}} = \spec{A-B} = \spec{A - JX^o}
        = \{ N - x_{11} \} \cup \spec{-X^o_{22}}
        \]
    \[ x_{11}, \spr{X^o_{22}} \leq r_0 \]
    \[ r_0 \leq 4\norm{B} \leq 4\sqrt{M} \]
\end{proof}
