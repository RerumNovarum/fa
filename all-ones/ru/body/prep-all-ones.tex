Матрицей единиц, размерности \( N \) будем называть матрицу
\( \mathscr{J}_{N} \in \mathrm{Matr}_{N\times N} \):
\[
    \mathscr{J}_{N} =
    \begin{pmatrix}
    1 & 1  & \cdots & 1 \\
    1 & 1  & \cdots & 1 \\
    \vdots & \vdots & \ddots & \vdots \\
    1 & 1  & \cdots & 1
    \end{pmatrix}
\]

Спектром матрицы \( A \) называется множество таких \( \lambda\in\mathbb{C} \),
что матрица \( {A - \lambda E} \) необратима \footnote{напомню, \( E \) --- единичная матрица}.

\begin{lemma}
    Имеет место равенство
    \begin{equation}\label{eq:allones-squared}
        \mathscr{J}_{N}^2 = N \mathscr{J}_{N}
    \end{equation}
    Из равенства \eqref{eq:allones-squared} следует, что
    \( p(\lambda) = \lambda^2-N\lambda \)
    есть минимальный многочлен \( \mathscr{J}_{N} \) и поэтому
    \[
        \mathrm{spec}\left({\mathscr{J}_{N}}\right) = \left\{ 0, N \right\}.
    \]
\end{lemma}

\begin{dfn}
    Две матрицы \( A_1, A_2 \)
    называются подобными, если существует обратимая матрица \( U \),
    такая что
    \[
        A_1 U = U A_2
        \]
    Или, эквивалентно:
    \[
        U^{-1} A_1 U = A_2
        \]
\end{dfn}

\begin{lemma}
    Матрица \( \mathscr{J}_{N} \) подобна матрице
    \begin{equation}\label{repr:allones-eigen}
        \begin{pmatrix}
            N       & 0      & \cdots & 0 \\
            0       & 0      & \cdots & 0 \\
            \vdots  & \vdots & \ddots & \vdots  \\
            0       & 0      & \cdots & 0
        \end{pmatrix}
    \end{equation}

    Её собственные векторы, соответствующие собственному значению \( 0 \)
    таковы, что сумма их координат равна нулю,
    а собственному значению \( N \) соответствует, например,
    вектор \( \left(1\cdots 1\right) \).

    Проводя ортогонализацию Грамма-Шмидта,
    получим ортогональную матрицу \( U \) преобразования \( \mathscr{J}_{N} \)
    к виду \eqref{repr:allones-eigen}:
    \begin{equation}\label{eq:diagtransform}
    U =
    \begin{pmatrix}
        1/\sqrt N &  1/\sqrt2 & 1/\sqrt6   & \cdots & a_{n-1} \\
        \vdots    & -1/\sqrt2 & 1/\sqrt6   & \cdots & a_{n-1} \\
        \vdots    & 0         & -2/\sqrt6  & \cdots & a_{n-1} \\
        \vdots    & \vdots    & 0          & \cdots & a_{n-1} \\
        \vdots    & \vdots    & \vdots     & \ddots & \vdots  \\
        \vdots    & \vdots    & \vdots     & \cdots & a_{n-1} \\
        1/\sqrt N & 0         & 0          & \cdots & -(n-1)a_{n-1}
        \end{pmatrix}.
        \end{equation}

        \begin{minipage}{0.9\textwidth}
            Её столбцы \( f_0, \ldots, f_{N-1} \)
            --- ортонормированный собственный базис матрицы \( \mathscr{J}_{N} \):

            \[f_0 = \begin{pmatrix} \frac{1}{\sqrt N} & \cdots & \frac{1}{\sqrt N} \end{pmatrix}^{\mathrm{T}}, \]
            \[
                f_1
             = \begin{pmatrix}a_1 & -a_1 & 0 & \cdots & 0 \end{pmatrix}^\mathrm{T}
                 = \begin{pmatrix}\frac1{\sqrt2} & - \frac{1}{\sqrt2} & 0 & \cdots & 0 \end{pmatrix}^\mathrm{T},
                     \]
            \[
                f_k =
                a_k
                \begin{pmatrix}1 & \cdots & 1 & -k & 0 & \cdots & 0 \end{pmatrix}^\mathrm{T},
                \]
            \[
                a_k = \frac{1}{k\sqrt{k a_{k-1}^2 b_{k-1}^2 + 1}},
            \]
        где \( k=\overline{2,N-1}. \)

                 Матрица такого вида ортогональна и поэтому
            \( U^{-1} = U^\star = U^{\mathrm{T}} \)
            (\( X^\mathrm{T} \) --- матрица, транспонированная к \( X\in\mathrm{Matr}_N \)).
        \end{minipage}
\end{lemma}
