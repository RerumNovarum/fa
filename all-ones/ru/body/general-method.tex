Матрицы из \( \mathtt{Matr}_N\mathbb{C} \) будем записывать в~блочном виде
\( X \sim
    \begin{pmatrix}
    x_{11} & X_{12} \\
    X_{21} & X_{22}
    \end{pmatrix}, \)
    где \( x_{11} \)~--- число,
    \( X_{12} \)~--- строка, \( X_{21} \)~--- столбец,
    \( X_{22} \)~--- квадратный блок размерности \( N-1 \).
Такие блочные матрицы сами образуют алгебру, изоморфную исходной
и~их можно естественным образом умножать
на элементы пространства \( \mathbb{C}\times\mathbb{C}^{N-1} \),
изоморфного~\( \mathbb{C}^N \):
\[
    \begin{pmatrix}
    x_{11} & X_{12} \\
    X_{21} & X_{22}
    \end{pmatrix}
    \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}
  = \begin{pmatrix}
      x_{11} x_1 + X_{12} x_2 \\
      X_{21} x_1 + X_{22} x_2
      \end{pmatrix},\quad x \sim \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}\in \mathbb{C}\times\mathbb{C}^{N-1}.
    \]
В~дальнейших выкладках изоморфные объекты понимаются взаимозаменяемыми.

Следуя общей схеме метода подобных операторов~\cite{baskakov-harmonic,baskakov1983},
будем искать более ``простую'' матрицу, подобную \( \mathcal{A} - \mathcal{B} \),
в~виде \( \mathcal{A} - \mathfrak{J} X \)
с~матрицей преобразования подобия \( E + \Gamma X \),
где \( E\in{\mathtt{Matr}_N\mathbb{C}} \)~--- единичная матрица,
\( \mathfrak{J},\Gamma : \mathtt{Matr}_N\mathbb{C}\to\mathtt{Matr}_N\mathbb{C} \)~--- линейные операторы,
действующие на алгебре \( \mathtt{Matr}_N\mathbb{C} \), подбираемые
в~ходе решения,
      прич\"ем \( \mathfrak{J} \) --- проектор (\(\mathfrak{J}^2=\mathfrak{J}\)),
      ``упрощающий'' возмущение \( \mathfrak{J}X \),
      а \( \Gamma \)
      при всех \( X\in {\mathtt{Matr}_N\mathbb{C}} \)
      удовлетворяет уравнению
          \( \mathcal{A}\Gamma X - (\Gamma X) \mathcal{A} = X - \mathfrak{J}X. \)

\begin{lem}
    В качестве \( \mathfrak{J} \)
        естественно выбрать оператор блочной диагонализации:
    \[
        \mathfrak{J} X = \begin{pmatrix} x_{11} & 0 \\ 0 & X_{22} \end{pmatrix}, \]
    При этом:
    \[
        \Gamma X = \frac{1}{N} \begin{pmatrix} 0 & X_{12} \\ -X_{21} & 0 \end{pmatrix}, \]
        для \( X\sim \begin{pmatrix}x_{11} & X_{12} \\ X_{21} & X_{22}\end{pmatrix} \in \mathtt{Matr}_N\mathbb{C} \).

\end{lem}
\begin{crl}
    Спектр блочно-диагональной матрицы
    \( \mathcal{A} - \mathfrak{J}X = \begin{pmatrix} N - x_{11} & 0 \\ 0 & -X_{22} \end{pmatrix} \)
    есть объединение спектров е\"е диагональных блоков:
    \[
        \sigma(\mathcal{A} - \mathfrak{J} X) = \{ N - x_{11} \} \cup \sigma(-X_{22}). \]
\end{crl}
\begin{proof}
Пусть \( \Gamma \) действует по формуле
\( \Gamma X = \begin{pmatrix} \Gamma_{11}(X) & \Gamma_{12}(X) \\
                              \Gamma_{21}(X) & \Gamma_{22}(X)
                              \end{pmatrix} \), тогда
\[
    \mathcal{A} \Gamma X - (\Gamma X)\mathcal{A} = 
    \begin{pmatrix} 0 & N\Gamma_{12}(X) \\
        - N\Gamma_{21}(X) & 0
        \end{pmatrix}, \]
и~уравнение для \( \Gamma X \) сводится~к
\[
    X - \mathfrak{J} X =
    N \begin{pmatrix} 0 & \Gamma_{12}(X) \\
        - \Gamma_{21}(X) & 0
        \end{pmatrix}. \]

Значит, \( \mathfrak{J} \) может обнулить вс\"е,
    кроме двух диагональных блоков размеров \( 1\times 1 \)
    и \( (N-1)\times(N-1) \),
поэтому для \( X =
    \begin{pmatrix}
    x_{11} & X_{12} \\
    X_{21} & X_{22}
    \end{pmatrix} \in \mathtt{Matr}_N\mathbb{C} \):
\[
    \mathfrak{J} X = \begin{pmatrix} x_{11} & 0 \\ 0 & X_{22} \end{pmatrix}, \]
\[
    \Gamma X = \frac{1}{N}\begin{pmatrix} 0 & X_{12} \\ -X_{21} & 0 \end{pmatrix}. \]
\end{proof}

Теперь выпишем уравнение подобия матриц \( \mathcal{A} - \mathcal{B} \)
и \( \mathcal{A} - \mathfrak{J} X \):
\begin{equation}\label{kozlukovsv:eq:similarity}
    (\mathcal{A-B})(E+\Gamma X) = (E+\Gamma X)(\mathcal{A} - \mathfrak{J} X), \quad X\in\mathtt{Matr}_N\mathbb{C}.
\end{equation}
\begin{lem}
    Уравнение~\eqref{kozlukovsv:eq:similarity} эквивалентно уравнению
    \begin{equation}\label{kozlukovsv:eq:fixptn}
        X = \mathcal{B} \Gamma X + \mathcal{B} - (\Gamma X)(\mathfrak{J}(\mathcal{B} (E + \Gamma X))), \quad X\in\mathtt{Matr}_N\mathbb{C}.
    \end{equation}
\end{lem}
\begin{proof}
Раскрывая скобки, уравнение~\eqref{kozlukovsv:eq:similarity} можно преобразовать к виду
\begin{equation}\label{kozlukovsv:eq:fixptn-ini}
    X = \mathcal{B} \Gamma X + \mathcal{B} - (\Gamma X) \mathfrak{J} X.
\end{equation}
Пусть для \( X \) выполнено~\eqref{kozlukovsv:eq:fixptn-ini}.
Тогда
    \begin{equation}\label{kozlukovsv:eq:jx}
        \mathfrak{J} X = \mathfrak{J}(\mathcal{B} (E + \Gamma X)).
    \end{equation}
Подставляя это выражение обратно в~\eqref{kozlukovsv:eq:fixptn-ini}
    получим~\eqref{kozlukovsv:eq:fixptn}.
Обратно, применяя \( \mathfrak{J} \) к обеим частям уравнения~\eqref{kozlukovsv:eq:fixptn},
    получаем~\eqref{kozlukovsv:eq:jx} и~\eqref{kozlukovsv:eq:fixptn-ini}.
\end{proof}

Выражение в правой части уравнения~\eqref{kozlukovsv:eq:fixptn} обозначим как
\[
    \Phi(X) = \mathcal{B} \Gamma X + \mathcal{B} - (\Gamma X)(\mathfrak{J}(\mathcal{B} (E + \Gamma X))).\]
Теперь покажем, что, при определ\"енных условиях,
возникшее нелинейное отображение \( \Phi:\mathtt{Matr}_N\mathbb{C}\to \mathtt{Matr}_N\mathbb{C} \) имеет инвариантным множеством
некоторый шар \( \Omega \subset \mathtt{Matr}_N\mathbb{C} \) с~центром в~нуле
(т.е.~\( \Phi(\Omega)\subset\Omega \)),
на котором оно является сжимающим.

Пусть в~\( \mathtt{Matr}_N\mathbb{C} \)
выбрана какая-нибудь субмультипликативная норма \( \|\cdot\| \)
(т.е.~норма, удовлетворяющая неравенству
 \( \| \mathcal{A}_1\mathcal{A}_2 \| \leq \|\mathcal{A}_1\|\|\mathcal{A}_2\| \)
 при всех \( \mathcal{A}_1, \mathcal{A}_2 \in \mathtt{Matr}_N\mathbb{C} \)).
В пространстве \( L(\mathtt{Matr}_N\mathbb{C}) \)
  линейных преобразований матриц размера \( N{\times}N \)
  будем рассматривать операторную норму
  \[
      \|\Psi\|_{\mathrm{op}} = \sup_{\|X\|=1,\ X\in\mathtt{Matr}_N\mathbb{C}} \|\Psi X\|,\ \Psi\in L(\mathtt{Matr}_N\mathbb{C})
      \]
Нам нужно найти такой радиус \( r \geq 0 \),
что при \( \|X\|,\|Y\| \leq r \) выполнялись бы неравенства \( \|\Phi(X)\| \leq r \)
и~\( \|\Phi(X) - \Phi(Y)\| < q\|X-Y\| \), \( q\in(0,1) \).
Обозначим
\( \beta = \|\mathcal{B}\| \), \( \gamma = \|\Gamma\|_{\mathrm{op}} = \sup_{\|X\|=1} \|\Gamma X\| \).

\begin{lem}
    Пусть \( \gamma\beta < \frac14\),
    тогда шар
    \[
        \Omega = \left\{ X\in \mathtt{Matr}_N\mathbb{C}; \|X\| \leq r_0 \right\}, \]
    \[  0 < r_0 = \frac{1 - 2\gamma\beta - \sqrt{1-4\gamma\beta}}{2\gamma^2\beta} < 4\beta, \]
    удовлетворяет условию \( \Phi(\Omega)\subset\Omega \).
\end{lem}
\begin{proof}
Очевидно неравенство
    \[ \| \Phi(X) \| \leq
     \beta \gamma^2 \|X\|^2 + 2\beta\gamma\|X\| + \beta. \]
Значит, если \( r \) удовлетворяет неравенству
    \begin{equation}\label{kozlukovsv:ineq:invariance-radius}
        \beta \gamma^2 r^2 + (2\beta\gamma - 1)r + \beta \leq 0,
    \end{equation}
    то \( \|\Phi(X)\| \leq r \) при всех \( \|X\| \leq r \).
Если \( \gamma\beta \leq \frac14 \),
    то дискриминант \( \Delta = 1-4\gamma\beta \)
    соответствующего уравнения положителен и~его корни вещественны.
Из знаков коэффициентов возникшего многочлена видно, что оба корня положительны.
Следовательно, наименьший положительный \( r \),
    удовлетворяющий неравенству~\eqref{kozlukovsv:ineq:invariance-radius}
    есть наименьший корень
    соответствующего уравнения:
    \[ r_0 = \frac{1 - 2\gamma\beta - \sqrt{1-4\gamma\beta}}{2\gamma^2\beta}. \]
Учитывая \( \gamma\beta<\frac14 \), имеем \( r_0 < 4\beta \).
\end{proof}

Аналогичным образом устанавливается
\begin{lem}
    Пусть \(\gamma\beta<\frac14\),
    тогда \( \Phi \)~--- сжимающее отображение:
    \[ \| \Phi(X) - \Phi(Y) \| \leq q \|X - Y\|, \quad X,Y\in\Omega \]
    \[ q = (1+2\gamma r_0) \gamma\beta \leq (1+8\gamma\beta)\gamma\beta \leq \frac34. \]
\end{lem}
\begin{proof}
    \begin{align*} \| \Phi(X) - \Phi(Y) \| = \| \mathcal{B}\Gamma (X-Y) + (\Gamma X)(\mathcal{B}\Gamma X + \mathcal{B})
     - (\Gamma Y)(\mathcal{B} \Gamma Y + \mathcal{B}) \| \leq \\
        \leq
     \beta\gamma\|X-Y\| +
     \beta \gamma^2 \|X-Y\| \|X+Y\| \leq \\
        \leq
     \beta\gamma\|X-Y\| +
     2 r_0 \beta \gamma^2 \|X-Y\|.
    \end{align*}
Здесь использовано равенство
\[ (\Gamma X) \mathfrak{J}(\mathcal{B}\Gamma X) - (\Gamma Y) \mathfrak{J}(\mathcal{B}\Gamma Y) =
    \frac12\left[
        \Gamma(X-Y) \mathfrak{J}(\mathcal{B}\Gamma(X+Y))
    +   \Gamma(X+Y) \mathfrak{J}(\mathcal{B}\Gamma(X-Y))
    \right]. \]
\end{proof}

Отсюда и~из теоремы Банаха о~неподвижной точке следует:
\begin{lem}
В~шаре \[ \Omega = \left\{ X\in\mathtt{Matr}_N\mathbb{C}; \quad \|X\| \leq r_0 \right\} \]
    существует и~при том единственное решение \( X^o \) уравнения~\eqref{kozlukovsv:eq:fixptn},
    являющееся пределом последовательности \( \{ \Phi^k(0); k\in\mathbb{N} \} \),
    где \( \Phi^k = \Phi\circ\Phi^{k-1} \)~--- композиция.
\end{lem}

\begin{crl}
    Матрица \( \mathcal{A} - \mathcal{B} \) подобна блочно-диагональной матрице \( \mathcal{A} - \mathfrak{J} X^o \):
    \[ \mathcal{A} - \mathcal{B} \sim
    \begin{pmatrix}
    N - x_{11}^o & 0 \\
    0 & -X_{22}^o
    \end{pmatrix}, \]
        при этом выполняются условия:
    \[ \sigma\left(\mathcal{A} - \mathcal{B}\right) = \left\{N-x_{11}^o\right\}\cup \sigma\left(-X_{22}^o\right), \]
        \[ x_{11}^o\in\mathbb{R}, \lvert x_{11}^o \rvert < r_0 \leq 4\beta, \]
    \[ \sigma\left(-X_{22}^o\right) \subset \{ \mu\in\mathbb{C}; \lvert x \rvert < r_0 \leq 4\beta \}. \]

    Собственное значение \( N - x_{11}^o \)
    совпадает со спектральным радиусом матрицы \( A-B \)
    и ему отвечает собственный вектор
    \[ 
        w = \mathcal{U}(E + \Gamma X)\begin{pmatrix}1\\0\end{pmatrix},
        \]
    \[
        \|w - \mathcal{U}\begin{pmatrix}1\\0\end{pmatrix}\|_2 \leq \frac{4\beta}{N}.
        \]
\end{crl}
\begin{proof}
    Матрица \( \mathcal{A} - \mathcal{B} \) подобна блочно-диагональной \( \mathcal{A} - \mathfrak{J} X^o \),
    поэтому их спектры совпадают.
    Спектр матрицы \( \mathcal{A} - \mathfrak{J} X^o \) есть объединение спектров е\"е диагональных блоков.
    В~виду субмультипликативности нормы имеют место неравенства
    \[ \mathtt{spr}(X^o) = \max_{\lambda\in\sigma(X^o)}\lvert\lambda\rvert \leq \|X^o\| \leq r_0. \]
    Кроме того, собственное значение \( x_{11}^o \) является вещественным, как предел сходящейся вещественной последовательности.

    Пусть теперь \( v \) --- собственный вектор матрицы \( \mathcal{A}-\mathfrak{J}X \):
    \[
        (\mathcal{A} - \mathfrak{J}X) v = \lambda v.
        \]
    Тогда
    \[
        (E+\Gamma X)^{-1}\mathcal{U}^{-1} (A - B) \mathcal{U} (E+\Gamma X) v = (A - \mathfrak{J}X)v = \lambda v,
        \]
    \[
        (A - B) \underbrace{\mathcal{U} (E+\Gamma X) v}_{w} = \lambda \underbrace{\mathcal{U} (E+\Gamma X) v}_{w},
        \]
    при этом
    \[
        \|w - \mathcal{U}v\|_2 = \|\mathcal{U}\Gamma X v\|_2 \leq
        \|\Gamma\|_{\mathrm{op}} \|X\|_{\mathrm{op}} \|\mathcal{U} v\|_2 \leq
        \frac{4\beta}{N} \|v\|.
        \]
    Здесь использована ортогональность матрицы \( \mathcal{U} \).
    Наибольшему собственному значению \( N - x_{11}^o \)
        матрицы \( \mathcal{A} - \mathfrak{J}X \) соответствует
        собственный вектор \( \begin{pmatrix}1\\ 0\end{pmatrix} \).
    Подставляя \( v = \begin{pmatrix}1\\ 0\end{pmatrix} \)
            получим желаемый результат.
\end{proof}
