\documentclass{article}

\usepackage{fontspec}
\setmainfont{CMU Serif}
\usepackage{polyglossia}
\setdefaultlanguage{russian}
\setotherlanguage{english}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{amsthm}

\newtheorem{thm}{Теорема }
\newtheorem{corollary}{Следствие }

\title{О спектральных свойствах некоторого специального класса матриц}
\author{Sergey Kozlukov}

\begin{document}
\maketitle

Пусть \( H \) --- \( M \)-мерное ( \( M < \infty \) ) линейное пространство,
\( A: H\to H \) --- линейный оператор с~простым спектром,
\( \lambda_1,~\ldots,~\lambda_M \) --- его (не~обязательно различные)
собственные значения, а \( e_1,~\ldots,~e_M \) --- соответствующие
собственные векторы, образующие Жорданов базис в \( H \).

Введём в \( H \) скалярное произведение, задав его на~базисных векторах
\( e_1,~\ldots,~e_M \):
\[ (e_i,e_j)_H = \delta_{ij}, \]
где \( \delta_{ij} = \left\{\begin{aligned} 1, i=j\\ 0, i\neq j\end{aligned}\right. \) --- символ Кронекера.

Рассмотрим Евклидово пространство \( \mathbb{H}=H^N \) ( \( N < \infty \) )
со скалярным произведением
\[ (x, y) = \sum_{i=1}^N (x_i,y_i)_H, \quad x=(x_1,\ldots,x_N),y=(y_1,\ldots,y_N) \in \mathbb{H}. \] 

В этом пространстве рассмотрим оператор
\[ \mathbb{A}: \mathbb{H}\to \mathbb{H}: \]
\[ \mathbb{A}x =
    \begin{pmatrix}
        A & \cdots & A \\
        \vdots & \ddots & \vdots \\
        A & \cdots & A
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        \vdots \\
        x_N
    \end{pmatrix}
    = \begin{pmatrix}
        A \sum_{i=1}^N x_i \\
        \vdots \\
        A \sum_{i=1}^N x_i
    \end{pmatrix},
    \quad x=(x_1,\ldots,x_N) \in \mathbb{H}. \]

 \begin{thm}
     Жорданова нормальная форма матрицы оператора \( \mathbb{A} \)
     имеет вид
%    Nl_1 0    ... 0    | 0 ... 0
%    0    Nl_2 ... 0    | 0 ... 0
%    ;    ;    `.  ;    | ; `.  ;
%    0    0    ... Nl_M | 0 ... 0
%    -------------------+--------
%    0    0    ... 0    | 0 ... 0
%    ;    ;    `.  ;    | ; `.  ;
%    0    0    ... 0    | 0 ... 0
     \begin{equation}\label{eq:ideal:jnf}
         \mathtt{JNF}(\mathbb{A})=
         \left(\begin{array}{cccc|ccc}
             N\lambda_1 & 0  & \cdots & 0 & 0 & \cdots & 0 \\
             0 & N\lambda_2  & \cdots & 0 & 0 & \cdots & 0 \\
             \vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
             0 & 0 & \cdots  & N\lambda_M & 0 & \cdots & 0 \\
             \hline
             0 & 0 & \cdots  & 0 & 0 & \cdots & 0 \\
             \vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
             0 & 0 & \cdots  & 0 & 0 & \cdots & 0
        \end{array}\right),
     \end{equation}
     а~Жорданов базис образуется ортонормированной относительно скалярного произведения в \( \mathbb{H} \) системой векторов:
     \begin{equation}\label{eq:ideal:jbasis-im}
         f_j^0 = \frac{1}{\sqrt{N}}\left( e_j~\cdots~e_j\right)\in\mathtt{Im}\mathbb{A},\quad
     j=\overline{1,M}, \end{equation}
     \begin{equation}\label{eq:ideal:jbasis-ker}
         f_j^k = \frac{1}{\sqrt{k(k+1)}}
                {\huge(}%\left(
                    \underbrace{e_j ~ \cdots ~ e_j}_{ k \text{ штук}} ~ -ke_j ~ 0 ~ \cdots ~ 0 {\huge)}\in\mathtt{Ker}\mathbb{A},
                    \quad k=\overline{1,N-1},j=\overline{1,M}
     .\end{equation} %\right). \]
 \end{thm}
 \begin{proof}
     Прежде всего заметим, что ортогональность векторов
     \[ f_j^k, \quad k=\overline{0,N-1}, j=\overline{1,M} \]
     проверяется непосредственно.

     Рассмотрим ядро оператора \( \mathbb{A} \):
     \[ \mathbb{H}_0 = \mathtt{Ker}\mathbb{A} \subset \mathbb{H}. \]
     Оно состоит из таких векторов \( x = (x_1 ~\cdots~ x_N) \in \mathbb{H} \),
     для которых \[ \sum_{i=1}^N x_i = 0 \in H. \]
     Ясно, что все \( MN - M \) ортогональных векторов \({ f_j^k, \quad k=\overline{1,N-1},j=\overline{1,M} }\)
     принадлежат \( \mathbb{H}_0 \).
     Они образуют базис в этом подпространстве, так как
     \( \mathtt{dim}\mathtt{Im}\mathbb{A} = \mathtt{rank}\mathbb{A} = \mathtt{rank}A = M \)
     и \( \mathtt{dim}\mathbb{H}_0 = \mathtt{dim}\mathbb{H} - \mathtt{dim}\mathtt{Im}\mathbb{A} = MN - M \).

     Теперь рассмотрим ортогональное к \( \mathbb{H}_0 \) подпространство
     \[ \mathbb{H}_1 = \mathbb{H}_0^\perp = \left\{ x\in\mathbb{H};\quad (x,y) \text{ для всех } y\in\mathbb{H}_0 \right\}. \]
     Вектор \( x=(x_1 ~\cdots~ x_N)\in\mathbb{H} \) лежит в \( \mathbb{H}_1 \)
     тогда и только тогда, когда
     \( x \) ортогонален всем базисным векторам в \( \mathbb{H}_0 \):
     \[ 0 = (x,h_i^k) = (x_k - x_{k+1}, e_j)_H, \quad k=\overline{1,N-1}, j=\overline{1,M}. \]
     Это означает, что \( x_k - x_{k+1} = 0 \), так как векторы \( x_k - x_{k+1} \in H \)
     ортогональны всем базисным векторам \( e_1, \ldots, e_M \in H \).

     Таким образом все векторы \( \mathbb{H}_1 \) имеют вид
     \[ x = (x_0 ~\cdots~ x_0)\in\mathbb{H}, \quad x_0\in H, \]
     а в качестве базиса в \( \mathbb{H}_1 \) естественно выбрать
     систему \( f_j^0, \quad j=\overline{1,M} \).

     Наконец, все найденные векторы являются собственными для \( \mathbb{A} \),
     а соответствующие им собственные значения могут быть найдены из равенств
     \[ \mathbb{A} f_j^0 = ( N A e_j ~\cdots~ NA e_j ~ -kNAe_j ~ 0 ~\cdots~ 0 ) = N\lambda_j f_j^0, \quad j=\overline{1,M} \]
     \[ \mathbb{A} f_j^k = 0 f_j^k, \quad j=\overline{1,M}, k=\overline{1,N-1}. \]
 \end{proof}

 \begin{corollary}
     Пусть \( \mathcal{A} = (a_{ij}) \) --- самосопряжённая матрица размера \( M\times M \),
     \( \lambda_1, \ldots, \lambda_M \) --- её (вообще говоря, не все различные) собственные значения,
     а \( e_1, \ldots, e_M \in H=\mathbb{R}^M \) --- соответствующие нормированные собственные векторы.
     Тогда блочная матрица
     \[ \mathfrak{A} = \begin{pmatrix}
         \mathcal{A} & \cdots & \mathcal{A} \\
         \vdots & \ddots & \vdots \\
         \mathcal{A} & \cdots & \mathcal{A}
     \end{pmatrix} \]
     размера \( MN\times MN \) имеет жордановы нормальную форму \eqref{eq:ideal:jnf}
     и базис вида \eqref{eq:ideal:jbasis-im}\eqref{eq:ideal:jbasis-ker},
     где векторы \( f_j^k\in H^N,\quad k=\overline{0,N-1},j=\overline{1,M} \)
     образуют ортонормированный жорданов (относительно \( \mathfrak{A} \))
     базис изоморфного к \( H^N \) евклидова пространства \( \mathbb{R}^{MN} \).
     При этом можно явно указать ортогональную матрицу перехода \( \mathfrak{U} \):
     \[
         \mathfrak{A} = \mathfrak{U} ~ \mathtt{JNF}(\mathbb{A}) ~ \mathfrak{U}^{-1}, \]
    \[ \mathfrak{U} = \mathtt{columns}(f_1^0,\ldots,f_M^0,f_1^1,\ldots,f_1^{N-1},\ldots,f_M^1,\ldots,f_M^{N-1}), \]
    \[ \mathfrak{U}^{-1} = \mathtt{rows}(f_1^0,\ldots,f_M^0,f_1^1,\ldots,f_1^{N-1},\ldots,f_M^1,\ldots,f_M^{N-1}), \]
     где \( \mathbb{A}:H^N\to H^N \) --- оператор, заданный матрицей \( \mathfrak{A} \),
     матрица \( \mathtt{JNF(\mathbb{A})} \) и векторы \( f_j^k \) --- из теоремы,
     а \( \mathtt{columns}(x_1,\ldots,x_n) \) и \( \mathtt{rows}(x_1,\ldots,x_n) \) обозначают матрицы,
     составленные из векторов \( x_1, \ldots, x_n \in \mathbb{R}^n \),
     записанных, соответственно, в столбец или строчку.
 \end{corollary}
 \begin{proof}
     Так как \( \mathcal{A} \) --- самосопряжённая,
     то её собственные векторы ортогональны относительно стандартного скалярного произведения в \( H=\mathbb{R}^M \),
     т.е. \( (e_i, e_j)_H = \delta_{ij} \).
     Значит, для оператора \( \mathbb{A}:\mathbb{H}\to\mathbb{H}, \quad \mathbb{H}=H^N \),
     заданного в каноническом для \( \mathbb{R}^{MN} \) базисе матрицей \( \mathfrak{A} \),
     выполняются условия предыдущей теоремы.
     Наконец, заметим, что построенное в доказательстве теоремы
     скалярное произведение \( (x,y) = \sum_{i=1}^N (x_i, y_i)_H, \quad x=(x_1~\cdots~x_N),y=(y_1~\cdots~y_N)\in\mathbb{H} \)
     совпадает с стандартным скалярным произведением в \( \mathbb{R}^{MN} \),
     а значит ортонормированные в \( \mathbb{H} \) векторы \( f_j^k \)
     образуют ортонормированную систему и в \( \mathbb{R}^{MN} \).
     Матрица перехода \( \mathfrak{U} \) составляется из ортогональных столбцов \( f_j^k \),
     поэтому она ортогональна, а обратная и транспонированная к ней матрицы совпадают.
 \end{proof}
\end{document}
